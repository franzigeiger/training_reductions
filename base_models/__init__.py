from base_models import global_data
from base_models.pruner import train as prune_train
from base_models.test_models import run_model_training, get_model
from base_models.trainer_convergence import train as conv_train
from base_models.trainer_images import train as image_train
from transformations.layer_based import apply_norm_dist, apply_norm_dist_kernel
from transformations.model_based import *
from transformations.transformation_utils import do_distribution_weight_init, do_distribution_gabor_init_channel, \
    do_kernel_normal_distribution_init, do_layer_normal_distribution_init, do_channel_normal_distribution_init, \
    do_poisson_kernel, do_dist_in_kernel, do_best_dist_init_kernel, prev_std_init_single, do_mutual_information, \
    do_eigenvalue_channel, do_eigenvalue_channel_dist, do_cluster_init

trained_models = {
    'CORnet-S_train_random': {'layers': ["decoder"]},
    'CORnet-S_train_all': {'layers': ['V1', 'V2', 'V4', 'IT', "decoder"]},
    'CORnet-S_full': {'layers': ['V1', 'V2', 'V4', 'IT', "decoder"]},
    'CORnet-S_full_con2': {'layers': ['V1', 'V2', 'V4', 'IT', "decoder"]},
    'CORnet-S_train_IT_random': {'layers': ['IT', 'decoder']},
    'CORnet-S_train_IT_seed_0': {'layers': ['IT', 'decoder']},
    'CORnet-S_train_norm_dist': {'layer_func': apply_norm_dist},
    'CORnet-S_train_norm_dist_kernel': {'layer_func': apply_norm_dist_kernel},
    'CORnet-S_train_V4': {'layers': ['V4', 'IT', 'decoder']},
    'CORnet-S_train_V2': {'model_func': apply_generic,
                          'layers': ['V2', 'V4', 'IT', "decoder"]},
    'CORnet-S_train_decoder': {'model_func': apply_generic, 'layers': ["decoder"]},
    'CORnet-S_train_gabor_scrumble': {'model_func': apply_gabors_scrumble,
                                      'layers': ['V1.conv2', 'V1.norm2', 'V2', 'V4', 'IT', "decoder"],
                                      'file': '/gabors_tiago_scaled_cornet_2.npy'},
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wm6_conv': {'model_func': apply_generic,
                                                      'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                      'V1.conv1': do_distribution_gabor_init,
                                                      'V1.conv2': do_distribution_gabor_init,
                                                      'V2.conv_input': do_kernel_normal_distribution_init,
                                                      'V2.skip': do_kernel_normal_distribution_init,
                                                      'V2.conv1': do_kernel_normal_distribution_init,
                                                      'V2.conv2': do_distribution_weight_init,
                                                      'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                      'file_1': '/gabors_conv2.npy',
                                                      'dim_5': 1, 'comp_5': 5
                                                      },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wm6_img': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_kernel_normal_distribution_init,
                                                     'V2.conv1': do_kernel_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     'dim_5': 1, 'comp_5': 5,
                                                     'images': 0.5
                                                     },
    'CORnet-S_train_gmk1_wmc2_kn3_kn4_ln5_wm6_ra': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_weight_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_kernel_normal_distribution_init,
                                                    'V2.conv1': do_layer_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True
                                                    },
    # CORnet-S_train_gmk1_wmc2_kn3_kn4_ln5_wm6_batchnorm_init
    'CORnet-S_train_gmk1_wmc2_kn3_kn4_ln5_wm6_bi': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_weight_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_kernel_normal_distribution_init,
                                                    'V2.conv1': do_layer_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True,
                                                    'bn_init': do_layer_normal_distribution_init
                                                    },
    'CORnet-S_train_gmk1_wmc2_kn3_kn4_bi': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_weight_init,
                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                            'V2.skip': do_kernel_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'dim_1': 1, 'comp_1': 8, 'batchnorm': True,
                                            'bn_init': do_layer_normal_distribution_init},
    'CORnet-S_train_gmk1_wmc2_kn3_kn4_ra': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_weight_init,
                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                            'V2.skip': do_kernel_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'dim_1': 1, 'comp_1': 8, 'batchnorm': True},
    'CORnet-S_train_gabor_dist_weight_dist_channel_bi': {'model_func': apply_generic,
                                                         'layers': ['V2', 'V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_weight_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'dim': 1, 'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init},
    'CORnet-S_train_gmk1_wmc2_kn3_bi': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4',
                                                   'IT', "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_weight_init,
                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'dim_1': 1, 'comp_1': 8, 'batchnorm': True,
                                        'bn_init': do_layer_normal_distribution_init},
    'CORnet-S_train_gabor_dist_weight_dist_channel_ra': {'model_func': apply_generic,
                                                         'layers': ['V2', 'V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_weight_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'dim': 1, 'batchnorm': True},
    'CORnet-S_train_gmk1_wmc2_kn3_ra': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4',
                                                   'IT', "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_weight_init,
                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'dim_1': 1, 'comp_1': 8, 'batchnorm': True,
                                        },
    'CORnet-S_train_gmk1_wmc2_ln3_bi': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4',
                                                   'IT', "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_weight_init,
                                        'V2.conv_input': do_layer_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'dim_1': 1, 'comp_1': 8, 'batchnorm': True,
                                        'bn_init': do_layer_normal_distribution_init},
    'CORnet-S_train_gmk1_wmc2_ln3_ra': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4',
                                                   'IT', "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_weight_init,
                                        'V2.conv_input': do_layer_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'dim_1': 1, 'comp_1': 8, 'batchnorm': True,
                                        },
    'CORnet-S_train_gabor_dist_both_kernel_ra': {'model_func': apply_generic,
                                                 'layers': ['V2', 'V4', 'IT', "decoder"],
                                                 'V1.conv1': do_distribution_gabor_init,
                                                 'V1.conv2': do_distribution_gabor_init,
                                                 'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                 'file_1': '/gabors_conv2.npy',
                                                 'batchnorm': True,
                                                 },
    'CORnet-S_train_gabor_dist_both_kernel_bi': {'model_func': apply_generic,
                                                 'layers': ['V2', 'V4', 'IT', "decoder"],
                                                 'V1.conv1': do_distribution_gabor_init,
                                                 'V1.conv2': do_distribution_gabor_init,
                                                 'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                 'file_1': '/gabors_conv2.npy',
                                                 'batchnorm': True,
                                                 'bn_init': do_layer_normal_distribution_init
                                                 },
    'CORnet-S_train_gabor_dist_kernel_gabor_dist_channel_ra': {'model_func': apply_generic,
                                                               'layers': ['V2', 'V4', 'IT', "decoder"],
                                                               'V1.conv1': do_distribution_gabor_init,
                                                               'V1.conv2': do_distribution_gabor_init_channel,
                                                               'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                               'file_1': '/gabors_conv2.npy',
                                                               'batchnorm': True,
                                                               },
    'CORnet-S_train_gabor_dist_kernel_gabor_dist_channel_bi': {'model_func': apply_generic,
                                                               'layers': ['V2', 'V4', 'IT', "decoder"],
                                                               'V1.conv1': do_distribution_gabor_init,
                                                               'V1.conv2': do_distribution_gabor_init_channel,
                                                               'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                               'file_1': '/gabors_conv2.npy',
                                                               'batchnorm': True,
                                                               'bn_init': do_layer_normal_distribution_init
                                                               },
    'CORnet-S_train_gmk1_gmk2_kn3_bi': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                   "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_gabor_init,
                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'file_1': '/gabors_conv2.npy',
                                        'batchnorm': True,
                                        'bn_init': do_layer_normal_distribution_init
                                        },
    'CORnet-S_train_gmk1_gmk2_kn3_ra': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                   "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_gabor_init,
                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'file_1': '/gabors_conv2.npy',
                                        'batchnorm': True,
                                        },
    'CORnet-S_train_gmk1_gmk2_ln3_bi': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                   "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_gabor_init,
                                        'V2.conv_input': do_layer_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'file_1': '/gabors_conv2.npy',
                                        'batchnorm': True,
                                        'bn_init': do_layer_normal_distribution_init
                                        },
    'CORnet-S_train_gmk1_gmk2_ln3_ra': {'model_func': apply_generic,
                                        'layers': ['V2.skip', 'V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                   "decoder"],
                                        'V1.conv1': do_distribution_gabor_init,
                                        'V1.conv2': do_distribution_gabor_init,
                                        'V2.conv_input': do_layer_normal_distribution_init,
                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                        'file_1': '/gabors_conv2.npy',
                                        'batchnorm': True,
                                        },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_ra': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_gabor_init,
                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                            'V2.skip': do_kernel_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'file_1': '/gabors_conv2.npy',
                                            'batchnorm': True,
                                            },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_bi': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_gabor_init,
                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                            'V2.skip': do_kernel_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'file_1': '/gabors_conv2.npy',
                                            'batchnorm': True,
                                            'bn_init': do_layer_normal_distribution_init
                                            },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_ra': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_gabor_init,
                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                            'V2.skip': do_layer_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'file_1': '/gabors_conv2.npy',
                                            'batchnorm': True,
                                            },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_bi': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_gabor_init,
                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                            'V2.skip': do_layer_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'file_1': '/gabors_conv2.npy',
                                            'batchnorm': True,
                                            'bn_init': do_layer_normal_distribution_init
                                            },
    'CORnet-S_train_gmk1_gmk2_ln3_ln4_bi': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_gabor_init,
                                            'V2.conv_input': do_layer_normal_distribution_init,
                                            'V2.skip': do_layer_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'file_1': '/gabors_conv2.npy',
                                            'batchnorm': True,
                                            'bn_init': do_layer_normal_distribution_init
                                            },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_bi': {'model_func': apply_generic,
                                            'layers': ['V2.conv1', 'V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                       "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_gabor_init,
                                            'V2.conv_input': do_layer_normal_distribution_init,
                                            'V2.skip': do_kernel_normal_distribution_init,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'file_1': '/gabors_conv2.npy',
                                            'batchnorm': True,
                                            'bn_init': do_layer_normal_distribution_init
                                            },
    'CORnet-S_train_gmk1_gmk2_ln3_ln4_ln5_ra': {'model_func': apply_generic,
                                                'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                           "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_layer_normal_distribution_init,
                                                'V2.skip': do_layer_normal_distribution_init,
                                                'V2.conv1': do_layer_normal_distribution_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                'batchnorm': True,
                                                },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_ra': {'model_func': apply_generic,
                                                'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                           "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_kernel_normal_distribution_init,
                                                'V2.skip': do_kernel_normal_distribution_init,
                                                'V2.conv1': do_kernel_normal_distribution_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                'batchnorm': True,
                                                },
    'CORnet-S_train_gmk1_gmk2_ln3_ln4_ln5_bi': {'model_func': apply_generic,
                                                'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                           "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_layer_normal_distribution_init,
                                                'V2.skip': do_layer_normal_distribution_init,
                                                'V2.conv1': do_layer_normal_distribution_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                'batchnorm': True,
                                                'bn_init': do_layer_normal_distribution_init
                                                },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_bi': {'model_func': apply_generic,
                                                'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                           "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_kernel_normal_distribution_init,
                                                'V2.skip': do_kernel_normal_distribution_init,
                                                'V2.conv1': do_kernel_normal_distribution_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_5': 1, 'comp_5': 5,  # 'dim_1': 1, 'comp_1': 8,
                                                'batchnorm': True,
                                                'bn_init': do_layer_normal_distribution_init
                                                },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_kn5_bi': {'model_func': apply_generic,
                                                'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                           "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_kernel_normal_distribution_init,
                                                'V2.skip': do_layer_normal_distribution_init,
                                                'V2.conv1': do_kernel_normal_distribution_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                'batchnorm': True,
                                                'bn_init': do_layer_normal_distribution_init
                                                },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_ln5_bi': {'model_func': apply_generic,
                                                'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                           "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_kernel_normal_distribution_init,
                                                'V2.skip': do_layer_normal_distribution_init,
                                                'V2.conv1': do_layer_normal_distribution_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                'batchnorm': True,
                                                'bn_init': do_layer_normal_distribution_init
                                                },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_bi': {'model_func': apply_generic,
                                                'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                           "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_layer_normal_distribution_init,
                                                'V2.skip': do_kernel_normal_distribution_init,
                                                'V2.conv1': do_layer_normal_distribution_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                'batchnorm': True,
                                                'bn_init': do_layer_normal_distribution_init
                                                },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_ln5_wm6_ra': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_kernel_normal_distribution_init,
                                                    'V2.conv1': do_layer_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True
                                                    },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_ln5_wm6_bi': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_kernel_normal_distribution_init,
                                                    'V2.conv1': do_layer_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True,
                                                    'bn_init': do_layer_normal_distribution_init
                                                    },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wm6_bi': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_kernel_normal_distribution_init,
                                                    'V2.conv1': do_kernel_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True,
                                                    'bn_init': do_layer_normal_distribution_init
                                                    },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wm6_ra': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_kernel_normal_distribution_init,
                                                    'V2.conv1': do_kernel_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True,
                                                    },
    'CORnet-S_train_gmk1_gmk2_ln3_ln4_ln5_wm6_ra': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_layer_normal_distribution_init,
                                                    'V2.skip': do_layer_normal_distribution_init,
                                                    'V2.conv1': do_layer_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True
                                                    },
    'CORnet-S_train_gmk1_gmk2_ln3_ln4_ln5_wm6_bi': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_layer_normal_distribution_init,
                                                    'V2.skip': do_layer_normal_distribution_init,
                                                    'V2.conv1': do_layer_normal_distribution_init,
                                                    'V2.conv2': do_distribution_weight_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                    'batchnorm': True,
                                                    'bn_init': do_layer_normal_distribution_init
                                                    },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_kn5_wmc6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_layer_normal_distribution_init,
                                                     'V2.conv1': do_kernel_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_ln5_wmc6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_layer_normal_distribution_init,
                                                     'V2.conv1': do_layer_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_ln5_wmk6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_layer_normal_distribution_init,
                                                     'V2.conv1': do_layer_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     'dim_5': 1, 'comp_5': 5, 'dim_1': 0, 'comp_1': 8,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_test': {'model_func': apply_generic,
                            'layers': ['V2.conv3', 'V4', 'IT',
                                       "decoder"],
                            'V1.conv1': do_distribution_gabor_init,
                            'V1.conv2': do_distribution_gabor_init,
                            'V2.conv_input': do_kernel_normal_distribution_init,
                            'V2.skip': do_layer_normal_distribution_init,
                            'V2.conv1': do_layer_normal_distribution_init,
                            'V2.conv2': do_distribution_weight_init,
                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                            'file_1': '/gabors_conv2.npy',
                            'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                            'batchnorm': True,
                            'bn_init': do_layer_normal_distribution_init
                            },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wmk6_kn7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_kernel_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_kernel_normal_distribution_init,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_kernel_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'dim_5': 0, 'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_ln5_wm6_bi_mom': {'model_func': apply_generic,
                                                        'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_distribution_gabor_init,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_kernel_normal_distribution_init,
                                                        'V2.conv1': do_layer_normal_distribution_init,
                                                        'V2.conv2': do_distribution_weight_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        'momentum': True
                                                        },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_wmc6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_layer_normal_distribution_init,
                                                     'V2.skip': do_kernel_normal_distribution_init,
                                                     'V2.conv1': do_layer_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     'dim_5': 1, 'comp_5': 5,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_wmk6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_layer_normal_distribution_init,
                                                     'V2.skip': do_kernel_normal_distribution_init,
                                                     'V2.conv1': do_layer_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     'dim_5': 0, 'comp_5': 5,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_wmc6_kn7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_layer_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_layer_normal_distribution_init,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_kernel_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'dim_5': 1, 'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wmc6_kn7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_kernel_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_kernel_normal_distribution_init,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_kernel_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'dim_5': 1, 'comp_5': 5, 'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wmc6_kn7_tr_bi': {'model_func': apply_generic,
                                                            'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                            'V1.conv1': do_distribution_gabor_init,
                                                            'V1.conv2': do_distribution_gabor_init,
                                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                                            'V2.skip': do_kernel_normal_distribution_init,
                                                            'V2.conv1': do_kernel_normal_distribution_init,
                                                            'V2.conv2': do_distribution_weight_init,
                                                            'V2.conv3': do_kernel_normal_distribution_init,
                                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                            'file_1': '/gabors_conv2.npy',
                                                            'dim_5': 1, 'comp_5': 5, 'batchnorm': True,
                                                            'bn_init': do_layer_normal_distribution_init
                                                            },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_wmc6_ln7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_layer_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_layer_normal_distribution_init,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_layer_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'dim_5': 1, 'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_wmk6_kn7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_layer_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_layer_normal_distribution_init,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_kernel_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'dim_5': 0, 'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_wmk6_ln7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_layer_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_layer_normal_distribution_init,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_layer_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'dim_5': 0, 'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_kn6_kn7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_distribution_gabor_init,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_kernel_normal_distribution_init,
                                                        'V2.conv1': do_kernel_normal_distribution_init,
                                                        'V2.conv2': do_kernel_normal_distribution_init,
                                                        'V2.conv3': do_kernel_normal_distribution_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'dim_5': 0, 'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init
                                                        },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_kn6_kn7train_bi': {'model_func': apply_generic,
                                                             'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                             'V1.conv1': do_distribution_gabor_init,
                                                             'V1.conv2': do_distribution_gabor_init,
                                                             'V2.conv_input': do_kernel_normal_distribution_init,
                                                             'V2.skip': do_kernel_normal_distribution_init,
                                                             'V2.conv1': do_kernel_normal_distribution_init,
                                                             'V2.conv2': do_kernel_normal_distribution_init,
                                                             'V2.conv3': do_kernel_normal_distribution_init,
                                                             'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                             'file_1': '/gabors_conv2.npy',
                                                             'dim_5': 0, 'batchnorm': True,
                                                             'bn_init': do_layer_normal_distribution_init
                                                             },
    'CORnet-S_train_wmk0_wmc1_bi': {'model_func': apply_generic,
                                    'layers': ['V2', 'V4', 'IT', "decoder"],
                                    'V1.conv1': do_distribution_weight_init,
                                    'V1.conv2': do_distribution_weight_init,
                                    'batchnorm': True,
                                    'bn_init': do_layer_normal_distribution_init,
                                    'dim_0': 0, 'dim_1': 1,
                                    },
    'CORnet-S_train_wmc0_wmc1_bi': {'model_func': apply_generic,
                                    'layers': ['V2', 'V4', 'IT', "decoder"],
                                    'V1.conv1': do_distribution_weight_init,
                                    'V1.conv2': do_distribution_weight_init,
                                    'batchnorm': True,
                                    'bn_init': do_layer_normal_distribution_init,
                                    'dim_0': 1, 'dim_1': 1,
                                    },
    'CORnet-S_train_kn1_kn2_bi': {'model_func': apply_generic,
                                  'layers': ['V2', 'V4', 'IT', "decoder"],
                                  'V1.conv1': do_kernel_normal_distribution_init,
                                  'V1.conv2': do_kernel_normal_distribution_init,
                                  'batchnorm': True,
                                  'bn_init': do_layer_normal_distribution_init
                                  },
    'CORnet-S_train_kn1_kn2_bi_v2': {'model_func': apply_generic,
                                     'layers': ['V2', 'V4', 'IT', "decoder"],
                                     'V1.conv1': do_kernel_normal_distribution_init,
                                     'V1.conv2': do_kernel_normal_distribution_init,
                                     'batchnorm': True,
                                     'bn_init': do_layer_normal_distribution_init
                                     },
    'CORnet-S_train_cn1_cn2_bi': {'model_func': apply_generic,
                                  'layers': ['V2', 'V4', 'IT', "decoder"],
                                  'V1.conv1': do_channel_normal_distribution_init,
                                  'V1.conv2': do_channel_normal_distribution_init,
                                  'batchnorm': True,
                                  'bn_init': do_layer_normal_distribution_init
                                  },
    'CORnet-S_train_kn1_kn2_bi_full': {'model_func': apply_generic,
                                       'layers': ['V2', 'V4', 'IT', "decoder"],
                                       'V1.conv1': do_kernel_normal_distribution_init,
                                       'V1.conv2': do_kernel_normal_distribution_init,
                                       'batchnorm': True,
                                       'bn_init': do_layer_normal_distribution_init,
                                       'full': True,
                                       },
    'CORnet-S_train_ln1_ln2_bi': {'model_func': apply_generic,
                                  'layers': ['V2', 'V4', 'IT', "decoder"],
                                  'V1.conv1': do_layer_normal_distribution_init,
                                  'V1.conv2': do_layer_normal_distribution_init,
                                  'batchnorm': True,
                                  'bn_init': do_layer_normal_distribution_init
                                  },
    'CORnet-S_train_bd1_bd2_bi': {'model_func': apply_generic,
                                  'layers': ['V2', 'V4', 'IT', "decoder"],
                                  'V1.conv1': do_best_dist_init_kernel,
                                  'V1.conv2': do_best_dist_init_kernel,
                                  'batchnorm': True,
                                  'bn_init': do_layer_normal_distribution_init
                                  },
    'CORnet-S_train_gmk1_bd2_bi': {'model_func': apply_generic,
                                   'layers': ['V2', 'V4', 'IT', "decoder"],
                                   'V1.conv1': do_distribution_gabor_init,
                                   'V1.conv2': do_best_dist_init_kernel,
                                   'batchnorm': True,
                                   'bn_init': do_layer_normal_distribution_init,
                                   'file': '/gabors_tiago_scaled_cornet_2.npy',
                                   },
    'CORnet-S_train_gabor_dist_both_kernel_bi_full': {'model_func': apply_generic,
                                                      'layers': ['V2', 'V4', 'IT', "decoder"],
                                                      'V1.conv1': do_distribution_gabor_init,
                                                      'V1.conv2': do_distribution_gabor_init,
                                                      'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                      'file_1': '/gabors_conv2.npy',
                                                      'batchnorm': True, 'full': True,
                                                      'bn_init': do_layer_normal_distribution_init,
                                                      },
    'CORnet-S_train_gmk1_gmk2_ln3_kn4_ln5_bi_full': {'model_func': apply_generic,
                                                     'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_layer_normal_distribution_init,
                                                     'V2.skip': do_kernel_normal_distribution_init,
                                                     'V2.conv1': do_layer_normal_distribution_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                     'batchnorm': True, 'full': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_gmk1_gmk2_kn3_ln4_ln5_wmc6_bi_full': {'model_func': apply_generic,
                                                          'layers': ['V2.conv3', 'V4', 'IT',
                                                                     "decoder"],
                                                          'V1.conv1': do_distribution_gabor_init,
                                                          'V1.conv2': do_distribution_gabor_init,
                                                          'V2.conv_input': do_kernel_normal_distribution_init,
                                                          'V2.skip': do_layer_normal_distribution_init,
                                                          'V2.conv1': do_layer_normal_distribution_init,
                                                          'V2.conv2': do_distribution_weight_init,
                                                          'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                          'file_1': '/gabors_conv2.npy',
                                                          'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                          'batchnorm': True, 'full': True,
                                                          'bn_init': do_layer_normal_distribution_init
                                                          },
    'CORnet-S_train_kn1_kn2_kn3_kn4_kn5_bi': {'model_func': apply_generic,
                                              'layers': ['V2.conv2', 'V2.conv3', 'V4', 'IT',
                                                         "decoder"],
                                              'V1.conv1': do_kernel_normal_distribution_init,
                                              'V1.conv2': do_kernel_normal_distribution_init,
                                              'V2.conv_input': do_kernel_normal_distribution_init,
                                              'V2.skip': do_kernel_normal_distribution_init,
                                              'V2.conv1': do_kernel_normal_distribution_init,
                                              'batchnorm': True,
                                              'bn_init': do_layer_normal_distribution_init
                                              },
    'CORnet-S_train_kn1_kn2_kn3_ln4_ln5_wmc6_bi': {'model_func': apply_generic,
                                                   'layers': ['V2.conv3', 'V4', 'IT',
                                                              "decoder"],
                                                   'V1.conv1': do_kernel_normal_distribution_init,
                                                   'V1.conv2': do_kernel_normal_distribution_init,
                                                   'V2.conv_input': do_kernel_normal_distribution_init,
                                                   'V2.skip': do_layer_normal_distribution_init,
                                                   'V2.conv1': do_layer_normal_distribution_init,
                                                   'V2.conv2': do_distribution_weight_init,
                                                   'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                   'batchnorm': True,
                                                   'bn_init': do_layer_normal_distribution_init
                                                   },
    'CORnet-S_train_wmc1_wmc2_kn3_ln4_ln5_wmc6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_weight_init,
                                                     'V1.conv2': do_distribution_weight_init,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_layer_normal_distribution_init,
                                                     'V2.conv1': do_layer_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'dim_0': 1, 'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_wmk1_wmk2_kn3_ln4_ln5_wmc6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_distribution_weight_init,
                                                     'V1.conv2': do_distribution_weight_init,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_layer_normal_distribution_init,
                                                     'V2.conv1': do_layer_normal_distribution_init,
                                                     'V2.conv2': do_distribution_weight_init,
                                                     'dim_0': 0, 'dim_5': 1, 'comp_5': 5, 'dim_1': 1, 'comp_1': 8,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_kn6_bi': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT',
                                                               "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_kernel_normal_distribution_init,
                                                    'V2.conv1': do_kernel_normal_distribution_init,
                                                    'V2.conv2': do_kernel_normal_distribution_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'batchnorm': True,
                                                    'bn_init': do_layer_normal_distribution_init
                                                    },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_poisson6': {'model_func': apply_generic,
                                                      'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                      'V1.conv1': do_distribution_gabor_init,
                                                      'V1.conv2': do_distribution_gabor_init,
                                                      'V2.conv_input': do_kernel_normal_distribution_init,
                                                      'V2.skip': do_kernel_normal_distribution_init,
                                                      'V2.conv1': do_kernel_normal_distribution_init,
                                                      'V2.conv2': do_poisson_kernel,
                                                      # 'V2.conv3': do_poisson_kernel,
                                                      'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                      'file_1': '/gabors_conv2.npy',
                                                      'dim_1': 1, 'dim_5': 1, 'comp_5': 5
                                                      },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_uniform6': {'model_func': apply_generic,
                                                      'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                      'V1.conv1': do_distribution_gabor_init,
                                                      'V1.conv2': do_distribution_gabor_init,
                                                      'V2.conv_input': do_kernel_normal_distribution_init,
                                                      'V2.skip': do_kernel_normal_distribution_init,
                                                      'V2.conv1': do_kernel_normal_distribution_init,
                                                      'V2.conv2': do_dist_in_kernel,
                                                      # 'V2.conv3': do_poisson_kernel,
                                                      'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                      'file_1': '/gabors_conv2.npy',
                                                      'distribution': 'uniform'
                                                      },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_beta6': {'model_func': apply_generic,
                                                   'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                   'V1.conv1': do_distribution_gabor_init,
                                                   'V1.conv2': do_distribution_gabor_init,
                                                   'V2.conv_input': do_kernel_normal_distribution_init,
                                                   'V2.skip': do_kernel_normal_distribution_init,
                                                   'V2.conv1': do_kernel_normal_distribution_init,
                                                   'V2.conv2': do_dist_in_kernel,
                                                   # 'V2.conv3': do_poisson_kernel,
                                                   'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                   'file_1': '/gabors_conv2.npy',
                                                   'distribution': 'beta'
                                                   },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_beta6_bi': {'model_func': apply_generic,
                                                      'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                      'V1.conv1': do_distribution_gabor_init,
                                                      'V1.conv2': do_distribution_gabor_init,
                                                      'V2.conv_input': do_kernel_normal_distribution_init,
                                                      'V2.skip': do_kernel_normal_distribution_init,
                                                      'V2.conv1': do_kernel_normal_distribution_init,
                                                      'V2.conv2': do_dist_in_kernel,
                                                      # 'V2.conv3': do_poisson_kernel,
                                                      'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                      'file_1': '/gabors_conv2.npy',
                                                      'distribution': 'beta',
                                                      'batchnorm': True,
                                                      'bn_init': do_layer_normal_distribution_init
                                                      },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_best6': {'model_func': apply_generic,
                                                   'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                   'V1.conv1': do_distribution_gabor_init,
                                                   'V1.conv2': do_distribution_gabor_init,
                                                   'V2.conv_input': do_kernel_normal_distribution_init,
                                                   'V2.skip': do_kernel_normal_distribution_init,
                                                   'V2.conv1': do_kernel_normal_distribution_init,
                                                   'V2.conv2': do_best_dist_init_kernel,
                                                   # 'V2.conv3': do_poisson_kernel,
                                                   'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                   'file_1': '/gabors_conv2.npy',
                                                   'distribution': 'beta'
                                                   },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_prev6': {'model_func': apply_generic,
                                                   'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                   'V1.conv1': do_distribution_gabor_init,
                                                   'V1.conv2': do_distribution_gabor_init,
                                                   'V2.conv_input': do_kernel_normal_distribution_init,
                                                   'V2.skip': do_kernel_normal_distribution_init,
                                                   'V2.conv1': do_kernel_normal_distribution_init,
                                                   'V2.conv2': prev_std_init_single,
                                                   # 'V2.conv3': do_poisson_kernel,
                                                   'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                   'file_1': '/gabors_conv2.npy',
                                                   'distribution': 'beta'
                                                   },
    'CORnet-S_train_gmk1_gmk2_kn3_mi4_kn5_kn6': {'model_func': apply_generic,
                                                 'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                 'V1.conv1': do_distribution_gabor_init,
                                                 'V1.conv2': do_distribution_gabor_init,
                                                 'V2.conv_input': do_kernel_normal_distribution_init,
                                                 'V2.skip': do_mutual_information,
                                                 'V2.conv1': do_kernel_normal_distribution_init,
                                                 'V2.conv2': do_kernel_normal_distribution_init,
                                                 # 'V2.conv3': do_poisson_kernel,
                                                 'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                 'file_1': '/gabors_conv2.npy',
                                                 'distribution': 'beta'
                                                 },
    'CORnet-S_train_gmk1_gmk2_best3-6': {'model_func': apply_generic,
                                         'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                         'V1.conv1': do_distribution_gabor_init,
                                         'V1.conv2': do_distribution_gabor_init,
                                         'V2.conv_input': do_best_dist_init_kernel,
                                         'V2.skip': do_best_dist_init_kernel,
                                         'V2.conv1': do_best_dist_init_kernel,
                                         'V2.conv2': do_best_dist_init_kernel,
                                         # 'V2.conv3': do_poisson_kernel,
                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                         'file_1': '/gabors_conv2.npy',
                                         },
    'CORnet-S_train_gmk1_gmk2_best3-7': {'model_func': apply_generic,
                                         'layers': ['V4', 'IT', "decoder"],
                                         'V1.conv1': do_distribution_gabor_init,
                                         'V1.conv2': do_distribution_gabor_init,
                                         'V2.conv_input': do_best_dist_init_kernel,
                                         'V2.skip': do_best_dist_init_kernel,
                                         'V2.conv1': do_best_dist_init_kernel,
                                         'V2.conv2': do_best_dist_init_kernel,
                                         'V2.conv3': do_best_dist_init_kernel,
                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                         'file_1': '/gabors_conv2.npy',
                                         },
    'CORnet-S_train_gmk1_gmk2_uniform3-7': {'model_func': apply_generic,
                                            'layers': ['V4', 'IT', "decoder"],
                                            'V1.conv1': do_distribution_gabor_init,
                                            'V1.conv2': do_distribution_gabor_init,
                                            'V2.conv_input': do_dist_in_kernel,
                                            'V2.skip': do_dist_in_kernel,
                                            'V2.conv1': do_dist_in_kernel,
                                            'V2.conv2': do_dist_in_kernel,
                                            'V2.conv3': do_dist_in_kernel,
                                            'file': '/gabors_tiago_scaled_cornet_2.npy',
                                            'file_1': '/gabors_conv2.npy',
                                            'distribution': 'uniform'
                                            },
    'CORnet-S_train_ev1_ev2_kn3_kn4_kn5_ev6_bi': {'model_func': apply_generic,
                                                  'layers': ['V2.conv3', 'V4', 'IT',
                                                             "decoder"],
                                                  'V1.conv1': do_eigenvalue_channel,
                                                  'V1.conv2': do_eigenvalue_channel,
                                                  'V2.conv_input': do_kernel_normal_distribution_init,
                                                  'V2.skip': do_kernel_normal_distribution_init,
                                                  'V2.conv1': do_kernel_normal_distribution_init,
                                                  'V2.conv2': do_eigenvalue_channel,
                                                  'batchnorm': True,
                                                  'bn_init': do_layer_normal_distribution_init
                                                  },
    'CORnet-S_train_evd1_evd2_kn3_kn4_kn5_evd6_bi': {'model_func': apply_generic,
                                                     'layers': ['V2.conv3', 'V4', 'IT',
                                                                "decoder"],
                                                     'V1.conv1': do_eigenvalue_channel_dist,
                                                     'V1.conv2': do_eigenvalue_channel_dist,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_kernel_normal_distribution_init,
                                                     'V2.conv1': do_kernel_normal_distribution_init,
                                                     'V2.conv2': do_eigenvalue_channel_dist,
                                                     'batchnorm': True,
                                                     'bn_init': do_layer_normal_distribution_init
                                                     },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_evd6': {'model_func': apply_generic,
                                                  'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                  'V1.conv1': do_distribution_gabor_init,
                                                  'V1.conv2': do_distribution_gabor_init,
                                                  'V2.conv_input': do_kernel_normal_distribution_init,
                                                  'V2.skip': do_kernel_normal_distribution_init,
                                                  'V2.conv1': do_kernel_normal_distribution_init,
                                                  'V2.conv2': do_eigenvalue_channel_dist,
                                                  # 'V2.conv3': do_poisson_kernel,
                                                  'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                  'file_1': '/gabors_conv2.npy',
                                                  },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_ev6': {'model_func': apply_generic,
                                                 'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                 'V1.conv1': do_distribution_gabor_init,
                                                 'V1.conv2': do_distribution_gabor_init,
                                                 'V2.conv_input': do_kernel_normal_distribution_init,
                                                 'V2.skip': do_kernel_normal_distribution_init,
                                                 'V2.conv1': do_kernel_normal_distribution_init,
                                                 'V2.conv2': do_eigenvalue_channel,
                                                 # 'V2.conv3': do_poisson_kernel,
                                                 'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                 'file_1': '/gabors_conv2.npy',
                                                 },
    'CORnet-S_train_gmk1_gmk2_bd3_mi4_bd57_bi': {'model_func': apply_generic,
                                                 'layers': ['V4', 'IT', "decoder"],
                                                 'V1.conv1': do_distribution_gabor_init,
                                                 'V1.conv2': do_distribution_gabor_init,
                                                 'V2.conv_input': do_best_dist_init_kernel,
                                                 'V2.skip': do_mutual_information,
                                                 'V2.conv1': do_best_dist_init_kernel,
                                                 'V2.conv2': do_best_dist_init_kernel,
                                                 'V2.conv3': do_best_dist_init_kernel,
                                                 'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                 'file_1': '/gabors_conv2.npy',
                                                 'batchnorm': True,
                                                 'bn_init': do_layer_normal_distribution_init
                                                 },
    'CORnet-S_train_gmk1_gmk2_bd3_7_bi': {'model_func': apply_generic,
                                          'layers': ['V4', 'IT', "decoder"],
                                          'V1.conv1': do_distribution_gabor_init,
                                          'V1.conv2': do_distribution_gabor_init,
                                          'V2.conv_input': do_best_dist_init_kernel,
                                          'V2.skip': do_best_dist_init_kernel,
                                          'V2.conv1': do_best_dist_init_kernel,
                                          'V2.conv2': do_best_dist_init_kernel,
                                          'V2.conv3': do_best_dist_init_kernel,
                                          'file': '/gabors_tiago_scaled_cornet_2.npy',
                                          'file_1': '/gabors_conv2.npy',
                                          'batchnorm': True,
                                          'bn_init': do_layer_normal_distribution_init
                                          },
    'CORnet-S_train_gmk1_gmk2_bd3_6_bi': {'model_func': apply_generic,
                                          'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                          'V1.conv1': do_distribution_gabor_init,
                                          'V1.conv2': do_distribution_gabor_init,
                                          'V2.conv_input': do_best_dist_init_kernel,
                                          'V2.skip': do_best_dist_init_kernel,
                                          'V2.conv1': do_best_dist_init_kernel,
                                          'V2.conv2': do_best_dist_init_kernel,
                                          'file': '/gabors_tiago_scaled_cornet_2.npy',
                                          'file_1': '/gabors_conv2.npy',
                                          'batchnorm': True,
                                          'bn_init': do_layer_normal_distribution_init
                                          },
    'CORnet-S_train_gmk1_gmk2_bd3_mi4_bd5_evd6_bd7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_best_dist_init_kernel,
                                                         'V2.skip': do_mutual_information,
                                                         'V2.conv1': do_best_dist_init_kernel,
                                                         'V2.conv2': do_eigenvalue_channel_dist,
                                                         'V2.conv3': do_best_dist_init_kernel,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_ev6_kn7': {'model_func': apply_generic,
                                                     'layers': ['V4', 'IT', "decoder"],
                                                     'V1.conv1': do_distribution_gabor_init,
                                                     'V1.conv2': do_distribution_gabor_init,
                                                     'V2.conv_input': do_kernel_normal_distribution_init,
                                                     'V2.skip': do_kernel_normal_distribution_init,
                                                     'V2.conv1': do_kernel_normal_distribution_init,
                                                     'V2.conv2': do_eigenvalue_channel_dist,
                                                     'V2.conv3': do_kernel_normal_distribution_init,
                                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                     'file_1': '/gabors_conv2.npy',
                                                     },
    'CORnet-S_train_gmk1_gmk2_wmk3_5_wmc6': {'model_func': apply_generic,
                                             'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                             'V1.conv1': do_distribution_gabor_init,
                                             'V1.conv2': do_distribution_gabor_init,
                                             'V2.conv_input': do_distribution_weight_init,
                                             'V2.skip': do_distribution_weight_init,
                                             'V2.conv1': do_distribution_weight_init,
                                             'V2.conv2': do_distribution_weight_init,
                                             # 'V2.conv3': do_distribution_weight_init,
                                             'file': '/gabors_tiago_scaled_cornet_2.npy',
                                             'file_1': '/gabors_conv2.npy',
                                             'dim_2': 0, 'dim_3': 0, 'dim_4': 0, 'dim_5': 1
                                             },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_ev6_kn7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_distribution_gabor_init,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_kernel_normal_distribution_init,
                                                        'V2.conv1': do_kernel_normal_distribution_init,
                                                        'V2.conv2': do_eigenvalue_channel_dist,
                                                        'V2.conv3': do_kernel_normal_distribution_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        },
    # 'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_ev6_kn7_bi_v2': {'model_func': apply_generic,
    #                                                        'layers': ['V4', 'IT', "decoder"],
    #                                                        'V1.conv1': do_distribution_gabor_init,
    #                                                        'V1.conv2': do_distribution_gabor_init,
    #                                                        'V2.conv_input': do_kernel_normal_distribution_init,
    #                                                        'V2.skip': do_kernel_normal_distribution_init,
    #                                                        'V2.conv1': do_kernel_normal_distribution_init,
    #                                                        'V2.conv2': do_eigenvalue_channel_dist,
    #                                                        'V2.conv3': do_kernel_normal_distribution_init,
    #                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
    #                                                        'file_1': '/gabors_conv2.npy',
    #                                                        'batchnorm': True,
    #                                                        'bn_init': do_layer_normal_distribution_init
    #                                                        },
    'CORnet-S_train_gmk1_gmk2_kn3_kmi_kn5_ev6_kn7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_distribution_gabor_init,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_mutual_information,
                                                        'V2.conv1': do_kernel_normal_distribution_init,
                                                        'V2.conv2': do_eigenvalue_channel,
                                                        'V2.conv3': do_kernel_normal_distribution_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init
                                                        },
    'CORnet-S_train_gmk1_gmk2_wmk3_5_wmc6_bi': {'model_func': apply_generic,
                                                'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                'V1.conv1': do_distribution_gabor_init,
                                                'V1.conv2': do_distribution_gabor_init,
                                                'V2.conv_input': do_distribution_weight_init,
                                                'V2.skip': do_distribution_weight_init,
                                                'V2.conv1': do_distribution_weight_init,
                                                'V2.conv2': do_distribution_weight_init,
                                                'V2.conv3': do_distribution_weight_init,
                                                'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                'file_1': '/gabors_conv2.npy',
                                                'dim_2': 0, 'dim_3': 0, 'dim_4': 0, 'dim_5': 1, 'dim_6': 0,
                                                'batchnorm': True,
                                                'bn_init': do_layer_normal_distribution_init
                                                },
    'CORnet-S_train_gmk1_gmk2_kn3_mi4_kn5_bd6_bi': {'model_func': apply_generic,
                                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                                    'V1.conv1': do_distribution_gabor_init,
                                                    'V1.conv2': do_distribution_gabor_init,
                                                    'V2.conv_input': do_kernel_normal_distribution_init,
                                                    'V2.skip': do_mutual_information,
                                                    'V2.conv1': do_kernel_normal_distribution_init,
                                                    'V2.conv2': do_best_dist_init_kernel,
                                                    # 'V2.conv3': do_kernel_normal_distribution_init,
                                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                    'file_1': '/gabors_conv2.npy',
                                                    'batchnorm': True,
                                                    'bn_init': do_layer_normal_distribution_init
                                                    },
    'CORnet-S_train_gmk1_gmk2_kn3_mi4_kn5_bd6_kn7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_distribution_gabor_init,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_mutual_information,
                                                        'V2.conv1': do_kernel_normal_distribution_init,
                                                        'V2.conv2': do_best_dist_init_kernel,
                                                        'V2.conv3': do_kernel_normal_distribution_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init
                                                        },
    'CORnet-S_train_gmk1_gmk2_kn3_mi4_kn5_wmc6_kn7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_kernel_normal_distribution_init,
                                                         'V2.skip': do_mutual_information,
                                                         'V2.conv1': do_kernel_normal_distribution_init,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_kernel_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init,
                                                         'dim_5': 1,
                                                         },
    'CORnet-S_train_gmk1_gmk2_bd3_mi4_bd5_wmc6_bd7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_best_dist_init_kernel,
                                                         'V2.skip': do_mutual_information,
                                                         'V2.conv1': do_best_dist_init_kernel,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_best_dist_init_kernel,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init,
                                                         'dim_5': 1,
                                                         },
    'CORnet-S_train_gmk1_gmk2_bd3_bd4_bd5_wmc6_bd7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_best_dist_init_kernel,
                                                         'V2.skip': do_best_dist_init_kernel,
                                                         'V2.conv1': do_best_dist_init_kernel,
                                                         'V2.conv2': do_distribution_weight_init,
                                                         'V2.conv3': do_best_dist_init_kernel,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init,
                                                         'dim_5': 1,
                                                         },
    'CORnet-S_train_gmk1_bd2_bd3_bd4_bd5_wmc6_bd7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_best_dist_init_kernel,
                                                        'V2.conv_input': do_best_dist_init_kernel,
                                                        'V2.skip': do_best_dist_init_kernel,
                                                        'V2.conv1': do_best_dist_init_kernel,
                                                        'V2.conv2': do_distribution_weight_init,
                                                        'V2.conv3': do_best_dist_init_kernel,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        'dim_5': 1,
                                                        },
    'CORnet-S_train_gmk1_bd2_bd3_mi4_bd5_wmc6_bd7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_best_dist_init_kernel,
                                                        'V2.conv_input': do_best_dist_init_kernel,
                                                        'V2.skip': do_mutual_information,
                                                        'V2.conv1': do_best_dist_init_kernel,
                                                        'V2.conv2': do_distribution_weight_init,
                                                        'V2.conv3': do_best_dist_init_kernel,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        'dim_5': 1,
                                                        },
    'CORnet-S_train_gmk1_cl2_bd3_mi4_bd5_wcl6_bd7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_cluster_init,
                                                        'V2.conv_input': do_best_dist_init_kernel,
                                                        'V2.skip': do_best_dist_init_kernel,
                                                        'V2.conv1': do_best_dist_init_kernel,
                                                        'V2.conv2': do_cluster_init,
                                                        'V2.conv3': do_best_dist_init_kernel,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        },
    'CORnet-S_train_gmk1_bd2_bd3_mi4_bd5_wcl6_bd7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_best_dist_init_kernel,
                                                        'V2.conv_input': do_best_dist_init_kernel,
                                                        'V2.skip': do_best_dist_init_kernel,
                                                        'V2.conv1': do_best_dist_init_kernel,
                                                        'V2.conv2': do_cluster_init,
                                                        'V2.conv3': do_best_dist_init_kernel,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        },
    'CORnet-S_train_gmk1_bd2_kn3_kn4_kn5_wcl6_kn7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_best_dist_init_kernel,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_kernel_normal_distribution_init,
                                                        'V2.conv1': do_kernel_normal_distribution_init,
                                                        'V2.conv2': do_cluster_init,
                                                        'V2.conv3': do_kernel_normal_distribution_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        },
    'CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wcl6_kn7_bi': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT', "decoder"],
                                                         'V1.conv1': do_distribution_gabor_init,
                                                         'V1.conv2': do_distribution_gabor_init,
                                                         'V2.conv_input': do_kernel_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_kernel_normal_distribution_init,
                                                         'V2.conv2': do_cluster_init,
                                                         'V2.conv3': do_kernel_normal_distribution_init,
                                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                         'file_1': '/gabors_conv2.npy',
                                                         'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init,
                                                         },
    'CORnet-S_train_gmk1_cl2_kn3_kn4_kn5_wcl6_kn7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_cluster_init,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_kernel_normal_distribution_init,
                                                        'V2.conv1': do_kernel_normal_distribution_init,
                                                        'V2.conv2': do_cluster_init,
                                                        'V2.conv3': do_kernel_normal_distribution_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        },
    'CORnet-S_train_gmk1_bd2_kn3_mi4_kn5_wcl6_kn7_bi': {'model_func': apply_generic,
                                                        'layers': ['V4', 'IT', "decoder"],
                                                        'V1.conv1': do_distribution_gabor_init,
                                                        'V1.conv2': do_best_dist_init_kernel,
                                                        'V2.conv_input': do_kernel_normal_distribution_init,
                                                        'V2.skip': do_mutual_information,
                                                        'V2.conv1': do_kernel_normal_distribution_init,
                                                        'V2.conv2': do_cluster_init,
                                                        'V2.conv3': do_kernel_normal_distribution_init,
                                                        'file': '/gabors_tiago_scaled_cornet_2.npy',
                                                        'file_1': '/gabors_conv2.npy',
                                                        'batchnorm': True,
                                                        'bn_init': do_layer_normal_distribution_init,
                                                        },
    'CORnet-S_train_gmk1_cl2_7_bi': {'model_func': apply_generic,
                                     'layers': ['V4', 'IT', "decoder"],
                                     'V1.conv1': do_distribution_gabor_init,
                                     'V1.conv2': do_cluster_init,
                                     'V2.conv_input': do_cluster_init,
                                     'V2.skip': do_cluster_init,
                                     'V2.conv1': do_cluster_init,
                                     'V2.conv2': do_cluster_init,
                                     'V2.conv3': do_cluster_init,
                                     'file': '/gabors_tiago_scaled_cornet_2.npy',
                                     'file_1': '/gabors_conv2.npy',
                                     'batchnorm': True,
                                     'bn_init': do_layer_normal_distribution_init,
                                     },
    'CORnet-S_train_gmk1_cl2_7_7tr_bi': {'model_func': apply_generic,
                                         'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                         'V1.conv1': do_distribution_gabor_init,
                                         'V1.conv2': do_cluster_init,
                                         'V2.conv_input': do_cluster_init,
                                         'V2.skip': do_cluster_init,
                                         'V2.conv1': do_cluster_init,
                                         'V2.conv2': do_cluster_init,
                                         'V2.conv3': do_cluster_init,
                                         'file': '/gabors_tiago_scaled_cornet_2.npy',
                                         'file_1': '/gabors_conv2.npy',
                                         'batchnorm': True,
                                         'bn_init': do_layer_normal_distribution_init,
                                         },
    'CORnet-S_train_wmk1_cl2_7_7tr_bi': {'model_func': apply_generic,
                                         'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                         'V1.conv1': do_distribution_weight_init,
                                         'V1.conv2': do_cluster_init,
                                         'V2.conv_input': do_cluster_init,
                                         'V2.skip': do_cluster_init,
                                         'V2.conv1': do_cluster_init,
                                         'V2.conv2': do_cluster_init,
                                         'V2.conv3': do_cluster_init,
                                         # 'file': '/gabors_tiago_scaled_cornet_2.npy',
                                         # 'file_1': '/gabors_conv2.npy',
                                         'batchnorm': True,
                                         'bn_init': do_layer_normal_distribution_init,
                                         'dim_0': 0,
                                         },
    'CORnet-S_train_cl1_7_7tr_bi': {'model_func': apply_generic,
                                    'layers': ['V2.conv3', 'V4', 'IT', "decoder"],
                                    'V1.conv1': do_cluster_init,
                                    'V1.conv2': do_cluster_init,
                                    'V2.conv_input': do_cluster_init,
                                    'V2.skip': do_cluster_init,
                                    'V2.conv1': do_cluster_init,
                                    'V2.conv2': do_cluster_init,
                                    'V2.conv3': do_cluster_init,
                                    # 'file': '/gabors_tiago_scaled_cornet_2.npy',
                                    # 'file_1': '/gabors_conv2.npy',
                                    'batchnorm': True,
                                    'bn_init': do_layer_normal_distribution_init,
                                    },
    'CORnet-S_train_gmk1_only_bi': {'model_func': apply_generic,
                                    'layers': ['V4', 'IT', "decoder"],
                                    'V1.conv1': do_distribution_gabor_init,
                                    'file': '/gabors_tiago_scaled_cornet_2.npy',
                                    'file_1': '/gabors_conv2.npy',
                                    'batchnorm': True,
                                    'bn_init': do_layer_normal_distribution_init,
                                    },
    'CORnet-S_train_gmk1_gmk2_cl3_7_bi': {'model_func': apply_generic,
                                          'layers': ['V4', 'IT', "decoder"],
                                          'V1.conv1': do_distribution_gabor_init,
                                          'V1.conv2': do_distribution_gabor_init,
                                          'V2.conv_input': do_cluster_init,
                                          'V2.skip': do_cluster_init,
                                          'V2.conv1': do_cluster_init,
                                          'V2.conv2': do_cluster_init,
                                          'V2.conv3': do_cluster_init,
                                          'file': '/gabors_tiago_scaled_cornet_2.npy',
                                          'file_1': '/gabors_conv2.npy',
                                          'batchnorm': True,
                                          'bn_init': do_layer_normal_distribution_init,
                                          },
    'CORnet-S_train_gmk1_cl2_bi': {'model_func': apply_generic,
                                   'layers': ['V2', 'V4', 'IT', "decoder"],
                                   'V1.conv1': do_distribution_gabor_init,
                                   'V1.conv2': do_cluster_init,
                                   'file': '/gabors_tiago_scaled_cornet_2.npy',
                                   'file_1': '/gabors_conv2.npy',
                                   'batchnorm': True,
                                   'bn_init': do_layer_normal_distribution_init,
                                   },
    'CORnet-S_train_kn1_kn2_kn3_kn4_kn5_kn6_kn7_bi_v2': {'model_func': apply_generic,
                                                         'layers': ['V4', 'IT',
                                                                    "decoder"],
                                                         'V1.conv1': do_kernel_normal_distribution_init,
                                                         'V1.conv2': do_kernel_normal_distribution_init,
                                                         'V2.conv_input': do_kernel_normal_distribution_init,
                                                         'V2.skip': do_kernel_normal_distribution_init,
                                                         'V2.conv1': do_kernel_normal_distribution_init,
                                                         'V2.conv2': do_kernel_normal_distribution_init,
                                                         'V2.conv3': do_kernel_normal_distribution_init,
                                                         'batchnorm': True,
                                                         'bn_init': do_layer_normal_distribution_init
                                                         },
    'CORnet-S_train_kn1_kn2_kn3_kn4_kn5_kn6_kn7_tr_bi_v2': {'model_func': apply_generic,
                                                            'layers': ['V2.conv3', 'V4', 'IT',
                                                                       "decoder"],
                                                            'V1.conv1': do_kernel_normal_distribution_init,
                                                            'V1.conv2': do_kernel_normal_distribution_init,
                                                            'V2.conv_input': do_kernel_normal_distribution_init,
                                                            'V2.skip': do_kernel_normal_distribution_init,
                                                            'V2.conv1': do_kernel_normal_distribution_init,
                                                            'V2.conv2': do_kernel_normal_distribution_init,
                                                            'V2.conv3': do_kernel_normal_distribution_init,
                                                            'batchnorm': True,
                                                            'bn_init': do_layer_normal_distribution_init
                                                            },
}

v4 = {
    'CORnet-S_brain_kn8_kn9_kn10_wmk11_kn12_bi': {
        'layers': ['IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 0},
    'CORnet-S_brain_kn8_kn9_kn10_wmc11_kn12_bi': {
        'layers': ['IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1},  #
    'CORnet-S_brain_kn8_kn9_kn10_wmk11_kn12_tr_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 0},
    'CORnet-S_brain_kn8_kn9_kn10_wmc11_kn12_tr_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1},  #
    'CORnet-S_brain_kn8_kn9_kn10_kn11_kn12_tr_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1},
    'CORnet-S_brain_kn8_kn9_kn10_wmc11_bi': {
        'layers': ['V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        # 'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1,
    },
    # wrong
    'CORnet-S_brain2_t7_kn8_kn9_kn10_kn11_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        # 'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1,
    },
    'CORnet-S_brain2_t7_t12_kn8_kn9_kn10_kn11_kn12_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1,
    },
    'CORnet-S_brain2_kn8_kn9_kn10_kn11_bi': {
        'layers': ['V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        # 'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1,
    },
    'CORnet-S_brain3_t7_t12_knall_IT_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain_t7_t12_wmk15_IT_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 0, 'dim_15': 0,
    },
    'CORnet-S_brain_wmc15_IT_bi': {
        'layers': ['IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_train_conv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
    },
    'CORnet-S_train_conv3_V4_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
    },
    'CORnet-S_train_conv3_V2_bi': {
        'layers': ['V2.conv3', 'V4', 'IT', 'decoder']
    },
    'CORnet-S_train_conv1_bi': {
        'layers': ['V2.conv1', 'V4.conv1', 'IT.conv1', 'decoder'],
    },
    'CORnet-S_train_conv1_V4_bi': {
        'layers': ['V2.conv1', 'V4.conv1', 'IT', 'decoder'],
    },
    'CORnet-S_train_conv1_V2_bi': {
        'layers': ['V2.conv1', 'V4', 'IT', 'decoder']
    },
    'CORnet-S_brain_t7_t12_wmc15_IT_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1, 'comp_15': 4
    },
    'CORnet-S_brain_IT_full_train': {
        'layers': ['V1', 'V2', 'V4', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1, 'comp_15': 4
    },
    'CORnet-S_brain_t7_t12_knk15_IT_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brain3_kn8_kn9_kn10_kn11_kn12_tra_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain4_kn8_kn9_kn10_kn11_kn12_tra_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain3_kn8_kn9_kn10_kn11_kn12_bi': {
        'layers': ['IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain3_kn8_kn9_kn10_kn11_kn12_bi_full': {
        'layers': ['IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain3_knall_IT_bi': {
        'layers': ['decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain3_knall_IT_bi_full': {
        'layers': ['decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'full': True,
    },
    'CORnet-S_brain3_IT_full_train': {
        'layers': ['V1', 'V2', 'V4', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'full': True,
    },
    'CORnet-S_brain3_knall_IT.conv2_bi': {
        'layers': ['IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_best_bd_mi_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_best_dist_init_kernel,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_best_dist_init_kernel,
        'IT.conv3': do_best_dist_init_kernel,
    },
    'CORnet-S_best_bd_mi_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_best_dist_init_kernel,
        'V4.conv3': do_best_dist_init_kernel,
    },
    'CORnet-S_dist_allbd_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_best_dist_init_kernel,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_best_dist_init_kernel,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_best_dist_init_kernel,
        'IT.conv3': do_best_dist_init_kernel,
    },
    'CORnet-S_dist_IT_full_train': {
        'layers': ['V1', 'V2', 'V4', 'IT', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_best_dist_init_kernel,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_best_dist_init_kernel,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_best_dist_init_kernel,
        'IT.conv3': do_best_dist_init_kernel,
    },
    'CORnet-S_dist_allbd_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_best_dist_init_kernel,
        'V4.conv3': do_best_dist_init_kernel,
    },
    'CORnet-S_mix2_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_best_dist_init_kernel,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_best_dist_init_kernel,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_mix2_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_best_dist_init_kernel,
        'V4.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain_do_dists': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_best_dist_init_kernel,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_ev_evd_kn_IT_trconv3_bi': {  #
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_eigenvalue_channel_dist,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_eigenvalue_channel_dist,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_mix_bd_evd_mi_IT_trconv3_bi': {  #
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_eigenvalue_channel_dist,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_eigenvalue_channel_dist,
        'IT.conv3': do_best_dist_init_kernel,
    },
    'CORnet-S_mix_bd_evd_mi_V4_trconv3_bi': {  #
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_eigenvalue_channel_dist,
        'V4.conv3': do_best_dist_init_kernel,
    },
    'CORnet-S_mixture_all_trconv3_bi': {  #
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_distribution_weight_init,
        'V4.skip': do_distribution_weight_init,
        'V4.conv1': do_distribution_weight_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_distribution_weight_init,
        'IT.conv_input': do_distribution_weight_init,
        'IT.skip': do_distribution_weight_init,
        'IT.conv1': do_distribution_weight_init,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_distribution_weight_init,
        'dim_10': 1, 'dim_15': 1, 'dim_9': 0, 'dim_8': 0,
        'dim_7': 0, 'dim_11': 0, 'dim_12': 0, 'dim_13': 0,
        'dim_14': 0, 'dim_16': 0,
    },
    'CORnet-S_brainmutual_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brainbest_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_best_dist_init_kernel,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brainbest2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_best_dist_init_kernel,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brainboth_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brainboth2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_distribution_weight_init,
        'IT.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brainmutual_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brainbest_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brainboth_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_distribution_weight_init,
        'V4.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_best_dist_init_kernel,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_best_dist_init_kernel,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_best_dist_init_kernel,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster3_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_best_dist_init_kernel,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_best_dist_init_kernel,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_best_dist_init_kernel,
        'IT.conv_input': do_best_dist_init_kernel,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_best_dist_init_kernel,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_best_dist_init_kernel,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster4_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster6_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster7_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster5_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_mutual_information,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_mutual_information,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_kernel_normal_distribution_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster2_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'IT.conv_input': do_cluster_init,
        'IT.skip': do_cluster_init,
        'IT.conv1': do_cluster_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'IT.conv_input': do_cluster_init,
        'IT.skip': do_cluster_init,
        'IT.conv1': do_cluster_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster2_IT_full_train': {
        'layers': ['V1', 'V2', 'V4', 'IT', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'IT.conv_input': do_cluster_init,
        'IT.skip': do_cluster_init,
        'IT.conv1': do_cluster_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster2_v2_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster9_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'IT.conv_input': do_cluster_init,
        'IT.skip': do_cluster_init,
        'IT.conv1': do_cluster_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster9_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster2_v2_IT_bi': {
        'layers': ['decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'IT.conv_input': do_cluster_init,
        'IT.skip': do_cluster_init,
        'IT.conv1': do_cluster_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster2_v2_V4_bi': {
        'layers': ['IT', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
    },
    'CORnet-S_cluster8_v2_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'IT.conv_input': do_cluster_init,
        'IT.skip': do_cluster_init,
        'IT.conv1': do_cluster_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_brain2_t7_t12_knall_IT_bi_v2': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain2_tconv3_knall_V4_bi_v2': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain2_knall_IT_bi_v2': {
        'layers': ['decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain2_knall_IT_bi_v2': {
        'layers': ['decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain2_IT_full_train': {
        'layers': ['V1', 'V2', 'V4', 'IT', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
        'IT.conv_input': do_kernel_normal_distribution_init,
        'IT.skip': do_kernel_normal_distribution_init,
        'IT.conv1': do_kernel_normal_distribution_init,
        'IT.conv2': do_kernel_normal_distribution_init,
        'IT.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_brain2_knall_V4_bi_v2': {
        'layers': ['V4', 'decoder'],
        'V4.conv_input': do_kernel_normal_distribution_init,
        'V4.skip': do_kernel_normal_distribution_init,
        'V4.conv1': do_kernel_normal_distribution_init,
        'V4.conv2': do_kernel_normal_distribution_init,
        'V4.conv3': do_kernel_normal_distribution_init,
    },
    'CORnet-S_cluster10_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'IT.conv_input': do_cluster_init,
        'IT.skip': do_cluster_init,
        'IT.conv1': do_cluster_init,
        'IT.conv2': do_cluster_init,
        'IT.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster10_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
        'V4.conv_input': do_cluster_init,
        'V4.skip': do_cluster_init,
        'V4.conv1': do_cluster_init,
        'V4.conv2': do_cluster_init,
        'V4.conv3': do_cluster_init,
        'dim_10': 1, 'dim_15': 1,
    },
    'CORnet-S_cluster11_IT_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT.conv3', 'decoder'],
    },
    'CORnet-S_cluster11_V4_trconv3_bi': {
        'layers': ['V2.conv3', 'V4.conv3', 'IT', 'decoder'],
    },
    'CORnet-S_train_batchnorm_V2': {
        'layers': ['V4', 'IT', 'decoder'],
        'all_batchnorm': True
    },
    'CORnet-S_train_batchnorm_V4': {
        'layers': ['IT', 'decoder'],
        'all_batchnorm': True
    },
    'CORnet-S_train_batchnorm': {
        'layers': ['decoder'],
        'all_batchnorm': True
    },

}


def get_config(model):
    if model not in trained_models:
        assert model in v4
        if model.split('_')[1] == 'brain':
            config = trained_models['CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wmc6_kn7_bi']
        elif model.split('_')[1] == 'brain2':
            config = trained_models['CORnet-S_train_kn1_kn2_kn3_kn4_kn5_kn6_kn7_bi_v2']
        elif model.split('_')[1] == 'brain3':
            config = trained_models['CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_kn6_kn7_bi']
        elif model.split('_')[1] == 'brain4':
            config = trained_models['CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wmk6_kn7_bi']
        elif model.split('_')[1] == 'best':
            config = trained_models['CORnet-S_train_gmk1_gmk2_bd3_mi4_bd57_bi']
        elif model.split('_')[1] == 'dist':
            config = trained_models['CORnet-S_train_gmk1_gmk2_bd3_7_bi']
        elif model.split('_')[1] == 'mix':
            config = trained_models['CORnet-S_train_gmk1_gmk2_bd3_mi4_bd5_evd6_bd7_bi']
        elif model.split('_')[1] == 'ev':
            config = trained_models['CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_ev6_kn7']
        elif model.split('_')[1] == 'mixture':
            config = trained_models['CORnet-S_train_gmk1_gmk2_wmk3_5_wmc6_bi']
        elif model.split('_')[1] == 'mix2':
            config = trained_models['CORnet-S_train_gmk1_gmk2_kn3_mi4_kn5_bd6_kn7_bi']
        elif model.split('_')[1] == 'brainmutual':
            config = trained_models['CORnet-S_train_gmk1_gmk2_kn3_mi4_kn5_wmc6_kn7_bi']
        elif model.split('_')[1] == 'brainbest':
            config = trained_models['CORnet-S_train_gmk1_gmk2_bd3_bd4_bd5_wmc6_bd7_bi']
        elif model.split('_')[1] == 'brainbest2':
            config = trained_models['CORnet-S_train_gmk1_bd2_bd3_bd4_bd5_wmc6_bd7_bi']
        elif model.split('_')[1] == 'brainboth2':
            config = trained_models['CORnet-S_train_gmk1_bd2_bd3_mi4_bd5_wmc6_bd7_bi']
        elif model.split('_')[1] == 'brainboth':
            config = trained_models['CORnet-S_train_gmk1_gmk2_bd3_mi4_bd5_wmc6_bd7_bi']
        elif model.split('_')[1] == 'cluster':
            config = trained_models['CORnet-S_train_gmk1_cl2_bd3_mi4_bd5_wcl6_bd7_bi']
        elif model.split('_')[1] == 'cluster2':
            config = trained_models['CORnet-S_train_gmk1_cl2_7_bi']
        elif model.split('_')[1] == 'cluster3':
            config = trained_models['CORnet-S_train_gmk1_bd2_bd3_mi4_bd5_wcl6_bd7_bi']
        elif model.split('_')[1] == 'cluster4':
            config = trained_models['CORnet-S_train_gmk1_bd2_kn3_kn4_kn5_wcl6_kn7_bi']
        elif model.split('_')[1] == 'cluster5':
            config = trained_models['CORnet-S_train_gmk1_bd2_kn3_mi4_kn5_wcl6_kn7_bi']
        elif model.split('_')[1] == 'cluster6':
            config = trained_models['CORnet-S_train_gmk1_gmk2_kn3_kn4_kn5_wcl6_kn7_bi']
        elif model.split('_')[1] == 'cluster7':
            config = trained_models['CORnet-S_train_gmk1_cl2_kn3_kn4_kn5_wcl6_kn7_bi']
        elif model.split('_')[1] == 'cluster8':
            config = trained_models['CORnet-S_train_gmk1_gmk2_cl3_7_bi']
        elif model.split('_')[1] == 'cluster9':
            config = trained_models['CORnet-S_train_wmk1_cl2_7_7tr_bi']
        elif model.split('_')[1] == 'cluster10':
            config = trained_models['CORnet-S_train_cl1_7_7tr_bi']
        elif model.split('_')[1] == 'cluster11':
            config = trained_models['CORnet-S_train_gmk1_only_bi']
        else:
            config = {}
        return {**config, **v4[model]}
    else:
        return trained_models[model]


# g = gabor, n=normal distribution, c=channel, k =kernel, w=weights, m= mixture, l=layer, j = jumbler, bd =best distribution
def train_model(model, train_func=None, images=0):
    config = get_config(model)
    train_conf_model(model, config, train_func, images)


def train_full_on_version(model, source, train_func):
    net = get_model(source, True)
    if global_data.seed != 0:
        model = f'{model}_seed{global_data.seed}'
    run_model_training(model=net, identifier=model, config={'full': True}, train_func=train_func)


def train_conf_model(model, config, train_func=None, images=0):
    if 'convergence' in config:
        train_func = conv_train
    if images != 0:
        model = f'{model}_img{images}'
        trainer_images.image_load = images
        print(f'We train with only {images} of images!')
        train_func = image_train
    net = get_model(model, False, config, train_func == prune_train)
    if global_data.seed != 0:
        model = f'{model}_seed{global_data.seed}'
    run_model_training(model=net, identifier=model, config=config, train_func=train_func)


if __name__ == '__main__':
    model = 'CORnet-S_cluster10_V4_trconv3_bi'
    model = get_model(model, False, get_config(model))
    assert model is not None
